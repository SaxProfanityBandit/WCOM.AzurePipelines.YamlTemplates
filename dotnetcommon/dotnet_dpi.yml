steps:
- ${{ if parameters.dpi.report }}:
  - pwsh: |
      if ((Get-Command dpi|Measure-Object).Count -lt 1)
      {
        dotnet tool install --global DPI
      }
    displayName: Checking for DPI tool installation.
    continueOnError: true

  - ${{ if eq(parameters.dpi.report, true) }}:
    - pwsh: dpi nuget -o table report
      continueOnError: true
      displayName: Creating DPI Report
      env:
        NuGetReportSettings_WorkspaceId: ${{ parameters.dpi.WorkspaceId }}
        NuGetReportSettings_SharedKey: ${{ parameters.dpi.SharedKey }}

  - ${{ if eq(parameters.dpi.report, false) }}:
    - pwsh: dpi nuget -o table analyze
      continueOnError: true
      displayName: Analyzing DPI (local output only)